*** AI STARTUP PROCEDURE - READ THIS FIRST ***

*** AI Must NEVER EDIT this file ***

Project: home-lab-setup - Building Proxmox VE DevOps/QA Environment

Hardware: HP Z8 G4 (Dual Xeon Platinum 8168, 256GB RAM, 6x NVMe ZFS)
DEV Host: HP Z8 G4 running Ubuntu 25.10 (where we work from)
Proxmox Server: HP Z8 G4 at 192.168.1.150 (root/[See PASSWORDS.md])

Apps: Capricorn (unified finance app)
- Production: capricorn.gothamtechnologies.com (GCP)
- QA: capricorn-qa.gothamtechnologies.com (home lab)


=== STARTUP CHECKLIST ===

1. ✅ Check current date/time including TimeZone using terminal
2. ✅ Read these files IN ORDER:
   a. MEMORY.md - Critical decisions & project context
   b. phases/current_phase.md - Latest work, decisions, and blockers
   c. PASSWORDS.md - All Passwords and Credentials stored here
   d. (Optional) /proxmox/Home_Lab_Proxmox_Design.md - Architecture philosophy & dual-access strategy
   e. (Optional) phases/phaseX_*.md - Read relevant phase files for detailed context on completed work
3. ✅ Git Status Check:
   a. Run `git fetch --all` to update remote tracking branches (GitHub/GitLab)
   b. Run `git status` to check:
      - Current branch
      - Uncommitted changes (staged/unstaged)
      - Unpushed commits (ahead of remote)
      - Unpulled commits (behind remote)
   c. Run `git log --oneline --graph --all -10` to see recent commit history
   d. For each configured remote (origin, gitlab, etc.):
      - Compare local HEAD with remote HEAD using `git rev-list --left-right --count <branch>...origin/<branch>`
   e. REPORT to user if ANY of these conditions exist:
      - "⚠️ Local has UNCOMMITTED changes (X files modified/staged)"
      - "⚠️ Local is AHEAD of <remote> by X commits (unpushed work)"
      - "⚠️ Local is BEHIND <remote> by X commits (need to pull)"
      - "⚠️ Local has DIVERGED from <remote> (both ahead and behind)"
      - "✅ Local matches all remotes - working on current version"
   f. If ANY warnings exist:
      - STOP and ask user: "How do you want to proceed? (pull/push/stash/review changes)"
      - DO NOT continue until user responds
4. ✅ Quick Context:
   - Building Proxmox VE 9.1 DevOps/QA lab on HP Z8 G4
   - 6 VMs: GitLab, Runner, QA Host, SonarQube, Monitoring, Traefik
   - ZFS storage: local-zfs (rpool1), vm-critical (rpool2), vm-ephemeral (rpool3)
   - Dual-access: Tailscale VPN (admin) + Public HTTPS (QA testing)
   - Capricorn = unified finance app (retired Finance/Portfolio/Retirement managers)
   - Domain: gothamtechnologies.com (AWS Route53)
   - Proxmox Web UI: https://192.168.1.150:8006 (root/[See PASSWORDS.md])
   - Phase 5 CI/CD: ✅ COMPLETE (QA + GCP automated deployments operational)

=== DIRECTORY RULES ===
- NEVER write outside project directory on this host
- Connect using SSH to hosts we build with generic username/pass in .env file

=== GitHub Account Info ===
available in github_credentials.md in project root

=== ⚠️ MANDATORY PROCESS FOR EACH PHASE (CRITICAL!) ===

**BEFORE implementing ANY phase, YOU MUST:**

1. CREATE detailed /phases/phaseX_name.md file FIRST
   - Include: Overview, detailed tasks, implementation approach
   - Include: Questions for user, decisions needed
   - Include: Code structure, file locations
   - Include: Testing approach, validation steps
   - Review /proxmox/Home_Lab_Proxmox_Build_Plan.md and Design.md for full context

2. PRESENT the phase plan to user for review
   - User will add "Things I Know" and specific requirements
   - User may modify approach or add constraints
   - User will ask questions and discuss details

3. WAIT for user approval before implementing
   - Do NOT start coding until user says "go ahead" or similar
   - User may request changes to the plan

4. IMPLEMENT only after user approval

5. DOCUMENT actual results in current phase* file
   - What was actually built (may differ from plan)
   - Issues encountered and solutions
   - Code locations and key decisions
   - Validation results

WHY THIS MATTERS:
- Prevents rebuilding work due to misunderstandings
- Captures user's domain knowledge before implementing
- Creates detailed documentation for future reference
- Ensures we don't lose context in long sessions

=== KEY CONFIG ===
- All passwords: [See PASSWORDS.md]
- NO Current AUTHENTICATION (single-user home lab app)
- NEVER commit to git without asking Andrew first

=== QA SERVER ACCESS ===
Credentials in .env (not committed to git)

=== ACCESS & ARCHITECTURE ===
- Admin access: Tailscale VPN (GitLab, SonarQube, Grafana = private)
- Public access: capricorn-qa.gothamtechnologies.com via Traefik (QA testing only)
- Infrastructure NOT exposed publicly (security by design)
- All VMs run Ubuntu 24.04 LTS (not 25.10)

=== IF CONTEXT UNCLEAR ===
Read MEMORY.md first, then /proxmox/Home_Lab_Proxmox_Build_Plan.md for current phase status.

Ready? Ask Andrew: "What would you like to work on today?" or wait for "Action CURSOR_RULES"
